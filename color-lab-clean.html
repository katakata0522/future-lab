<html lang="ja"><head>


<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>ã‚ãã‚ãï¼ã„ã‚ã®ã˜ã£ã‘ã‚“ã—ã¤DX</title>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Google Fonts (ä¸¸æ–‡å­—ãƒ•ã‚©ãƒ³ãƒˆ) -->
<link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&amp;display=swap" rel="stylesheet">
<!-- Material Icons -->
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@40,700,1,0" rel="stylesheet">
<style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #FFFBEB; /* è–„ã„é»„è‰² */
            background-image: radial-gradient(#FDE68A 2px, transparent 2px);
            background-size: 24px 24px;
        }

        /* ãƒãƒƒãƒ—ãªã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
            height: 20px;
            cursor: pointer;
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 16px;
            border-radius: 10px;
            border: 2px solid rgba(0,0,0,0.1);
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 32px;
            width: 32px;
            border-radius: 50%;
            margin-top: -10px;
            border: 4px solid white;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:active {
            transform: scale(1.2);
        }

        /* è‰²åˆ¥ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #slider-r::-webkit-slider-runnable-track { background: #FECACA; }
        #slider-r::-webkit-slider-thumb { background: #EF4444; }

        #slider-g::-webkit-slider-runnable-track { background: #BBF7D0; }
        #slider-g::-webkit-slider-thumb { background: #22C55E; }

        #slider-b::-webkit-slider-runnable-track { background: #BFDBFE; }
        #slider-b::-webkit-slider-thumb { background: #3B82F6; }

        /* ã‚²ãƒ¼ãƒ ç”¨ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ */
        .game-slider::-webkit-slider-runnable-track { background: #E2E8F0; }
        .game-slider::-webkit-slider-thumb { background: #64748B; }

        /* ã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .pop-card {
            background: white;
            border-radius: 24px;
            border: 4px solid #F3F4F6;
            box-shadow: 0 8px 0 #E5E7EB;
            transition: transform 0.2s;
        }

        /* ã·ã‚‹ã·ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes jelly {
            0%, 100% { transform: scale(1, 1); }
            25% { transform: scale(0.9, 1.1); }
            50% { transform: scale(1.1, 0.9); }
            75% { transform: scale(0.95, 1.05); }
        }
        .animate-jelly {
            animation: jelly 0.5s;
        }

        /* Blob Animation */
        @keyframes blob {
            0% { border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; }
            100% { border-radius: 60% 40% 30% 70% / 60% 50% 50% 50%; }
        }

        .text-shadow-sm {
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="text-slate-700 min-h-screen flex flex-col overflow-hidden selection:bg-yellow-200">
<!-- Header -->
<header class="bg-white border-b-4 border-yellow-200 px-4 py-3 flex justify-between items-center z-20 flex-shrink-0 shadow-sm">
<div class="flex items-center gap-2 md:gap-3">
<div class="bg-yellow-400 text-white p-2 rounded-2xl shadow-[0_4px_0_rgba(217,119,6,0.5)] transform rotate-[-5deg]">
<span class="material-symbols-rounded text-2xl md:text-3xl block">palette</span>
</div>
<div>
<h1 class="text-lg md:text-2xl font-black tracking-wider text-slate-800 text-shadow-sm">ã„ã‚ã®ã˜ã£ã‘ã‚“ã—ã¤ DX</h1>
</div>
</div>
<div class="flex gap-2">
<!-- Mode Switcher -->
<div class="flex bg-slate-100 p-1 rounded-2xl border-2 border-slate-200">
<button class="px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold transition-all bg-yellow-400 text-white shadow-[0_2px_0_rgba(180,83,9,0.3)] flex items-center gap-1 md:gap-2" id="tab-lab" onclick="switchTab('lab')">
<span class="material-symbols-rounded text-sm md:text-base">science</span>
<span>ã¤ãã‚‹</span>
</button>
<button class="px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold text-slate-400 hover:text-slate-600 transition-all flex items-center gap-1 md:gap-2" id="tab-game" onclick="switchTab('game')">
<span class="material-symbols-rounded text-sm md:text-base">sports_esports</span>
<span>ã‚ãã¶</span>
</button>
</div>
<!-- DOWNLOAD BUTTON -->
<button class="bg-slate-800 hover:bg-slate-700 text-white px-3 py-1.5 md:px-4 md:py-2 rounded-2xl font-bold flex items-center gap-2 shadow-lg transition-transform hover:scale-105 active:scale-95 ml-1" onclick="downloadSource()">
<span class="material-symbols-rounded">save</span>
<span class="hidden md:inline">ä¿å­˜ã™ã‚‹</span>
</button>
</div>
</header>
<!-- Main Content -->
<main class="flex-1 relative overflow-hidden">
<!-- ==================== MODE 1: LAB (ã¤ãã‚‹) ==================== -->
<div class="absolute inset-0 flex flex-col md:flex-row p-4 md:p-6 gap-6 overflow-y-auto pb-24 md:pb-6" id="view-lab">
<!-- Left: Controls -->
<div class="w-full md:w-5/12 flex flex-col gap-6">
<!-- Color Mixers -->
<div class="pop-card p-6 flex-shrink-0">
<div class="flex items-center gap-2 mb-6">
<span class="text-2xl">ğŸ¨</span>
<h2 class="text-xl font-bold text-slate-700">ã„ã‚ã‚’ ã¾ãœã¦ã¿ã‚ˆã†ï¼</h2>
</div>
<!-- Red -->
<div class="mb-6">
<div class="flex justify-between items-end mb-2">
<label class="font-bold text-red-500 text-lg flex items-center gap-2">
<span class="material-symbols-rounded">local_fire_department</span>
                                ã‚ã‹ (Red)
                            </label>
<span class="font-mono font-bold text-xl bg-red-100 text-red-600 px-3 py-1 rounded-lg" id="txt-r">0</span>
</div>
<input id="slider-r" max="255" min="0" type="range" value="128">
</div>
<!-- Green -->
<div class="mb-6">
<div class="flex justify-between items-end mb-2">
<label class="font-bold text-green-500 text-lg flex items-center gap-2">
<span class="material-symbols-rounded">grass</span>
                                ã¿ã©ã‚Š (Green)
                            </label>
<span class="font-mono font-bold text-xl bg-green-100 text-green-600 px-3 py-1 rounded-lg" id="txt-g">0</span>
</div>
<input id="slider-g" max="255" min="0" type="range" value="128">
</div>
<!-- Blue -->
<div class="mb-2">
<div class="flex justify-between items-end mb-2">
<label class="font-bold text-blue-500 text-lg flex items-center gap-2">
<span class="material-symbols-rounded">water_drop</span>
                                ã‚ãŠ (Blue)
                            </label>
<span class="font-mono font-bold text-xl bg-blue-100 text-blue-600 px-3 py-1 rounded-lg" id="txt-b">0</span>
</div>
<input id="slider-b" max="255" min="0" type="range" value="128">
</div>
</div>
<!-- Recipes -->
<div class="pop-card p-5 flex-1 bg-white/80">
<div class="flex items-center gap-2 mb-4">
<span class="text-2xl">ğŸ“–</span>
<h2 class="text-lg font-bold text-slate-700">ã„ã‚ã®ãƒ¬ã‚·ãƒ”</h2>
</div>
<div class="grid grid-cols-2 gap-3">
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(255,255,255, 'ã¾ã£ã—ã‚')">
<div class="w-8 h-8 rounded-full bg-white border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ã—ã‚</span>
</button>
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(0,0,0, 'ã¾ã£ãã‚')">
<div class="w-8 h-8 rounded-full bg-black border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ãã‚</span>
</button>
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(255,165,0, 'ã‚ªãƒ¬ãƒ³ã‚¸')">
<div class="w-8 h-8 rounded-full bg-orange-400 border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ã‚ªãƒ¬ãƒ³ã‚¸</span>
</button>
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(255,255,0, 'ãã„ã‚')">
<div class="w-8 h-8 rounded-full bg-yellow-400 border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ãã„ã‚</span>
</button>
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(128,0,128, 'ã‚€ã‚‰ã•ã')">
<div class="w-8 h-8 rounded-full bg-purple-600 border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ã‚€ã‚‰ã•ã</span>
</button>
<button class="p-3 rounded-xl border-2 border-slate-100 hover:border-yellow-300 hover:bg-yellow-50 transition-all text-left flex items-center gap-3 group bg-white shadow-sm" onclick="setRGB(255,192,203, 'ãƒ”ãƒ³ã‚¯')">
<div class="w-8 h-8 rounded-full bg-pink-300 border-2 border-slate-200 shadow-sm"></div>
<span class="font-bold text-slate-600 group-hover:text-yellow-600">ãƒ”ãƒ³ã‚¯</span>
</button>
</div>
</div>
</div>
<!-- Right: Character Preview -->
<div class="w-full md:w-7/12 flex flex-col">
<div class="pop-card flex-1 p-8 flex flex-col items-center justify-center relative bg-white border-dashed border-4 border-slate-200 overflow-hidden">
<!-- Background Pattern inside card -->
<div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#000 1px, transparent 1px); background-size: 20px 20px;"></div>
<!-- Character -->
<div class="relative w-64 h-64 md:w-80 md:h-80 transition-colors duration-200 ease-out flex items-center justify-center filter drop-shadow-xl animate-jelly" id="blob-character" style="background-color: rgb(0, 0, 0); border-radius: 40% 60% 70% 30% / 40% 50% 60%; animation: 3s ease 0s infinite alternate none running blob; color: rgb(255, 255, 255);">
<!-- Face (SVG) -->
<svg class="relative z-10 opacity-80" height="120" viewBox="0 0 100 100" width="120">
<!-- Eyes -->
<circle class="face-part" cx="30" cy="40" fill="currentColor" r="10"></circle>
<circle class="face-part" cx="70" cy="40" fill="currentColor" r="10"></circle>
<!-- Shine in eyes -->
<circle cx="34" cy="36" fill="white" r="3"></circle>
<circle cx="74" cy="36" fill="white" r="3"></circle>
<!-- Mouth -->
<path class="face-part" d="M 30 65 Q 50 80 70 65" fill="transparent" stroke="currentColor" stroke-linecap="round" stroke-width="6"></path>
</svg>
<!-- Shine effect on blob -->
<div class="absolute top-10 left-10 w-16 h-8 bg-white opacity-20 rounded-full transform -rotate-45"></div>
</div>
<!-- Chat Bubble -->
<div class="absolute top-4 right-4 md:right-10 bg-white px-4 py-2 rounded-2xl shadow-md border-2 border-slate-100 transform rotate-3 animate-bounce">
<p class="font-bold text-slate-600 text-sm">ã¼ãã¯ <span class="text-indigo-500" id="color-name-display">ã¾ã£ãã‚</span>ï¼</p>
</div>
<!-- Code Box (Friendly) -->
<div class="absolute bottom-6 w-full max-w-md px-4">
<div class="bg-slate-800 rounded-2xl p-4 text-white shadow-lg flex items-center justify-between gap-4">
<div>
<p class="text-xs text-slate-400 font-bold mb-0.5">ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰</p>
<p class="text-[10px] text-slate-500 mb-1 opacity-70">ã„ã‚ã‚’ ã‚ã‚‰ã‚ã™ ã“ã¨ã°ã ã‚ˆ</p>
<div class="font-mono text-xl font-bold tracking-wider" id="hex-code">#000000</div>
</div>
<button class="bg-white/10 hover:bg-white/20 active:scale-95 transition rounded-xl p-3 flex flex-col items-center gap-1" onclick="copyColor()">
<span class="material-symbols-rounded text-xl">content_copy</span>
<span class="text-[10px] font-bold">ã‚³ãƒ”ãƒ¼</span>
</button>
</div>
</div>
</div>
</div>
</div>
<!-- ==================== MODE 2: GAME (ã‚ãã¶) ==================== -->
<div class="hidden absolute inset-0 flex flex-col p-4 md:p-6 overflow-y-auto pb-24 md:pb-6 bg-blue-50" id="view-game">
<!-- GAME: Course Selection Screen -->
<div class="max-w-4xl mx-auto w-full h-full flex flex-col items-center justify-center gap-8 animate-jelly" id="game-menu">
<div class="text-center">
<h2 class="text-3xl md:text-5xl font-black text-slate-800 mb-4 text-shadow-sm">ã‚³ãƒ¼ã‚¹ã‚’ãˆã‚‰ã‚“ã§ã­ï¼</h2>
<p class="text-slate-500 font-bold text-lg">ãœã‚“ã‚‚ã‚“ã›ã„ã‹ã„ ã§ãã‚‹ã‹ãªï¼Ÿ</p>
</div>
<div class="flex flex-col md:flex-row gap-6 w-full max-w-2xl px-4">
<!-- Normal Course -->
<button class="flex-1 bg-white hover:bg-green-50 border-4 border-green-400 rounded-3xl p-8 shadow-lg hover:shadow-xl hover:scale-105 transition-all group text-left relative overflow-hidden" onclick="startGame('normal')">
<div class="relative z-10">
<span class="bg-green-100 text-green-600 px-3 py-1 rounded-full text-xs font-black tracking-widest mb-2 inline-block">ã‹ã‚“ãŸã‚“</span>
<h3 class="text-2xl font-black text-green-600 mb-2">ãµã¤ã† ã‚³ãƒ¼ã‚¹</h3>
<p class="text-slate-500 text-sm font-bold">ãã»ã‚“ã® ã„ã‚ãŒ ãŠãŠã„ã‚ˆã€‚<br>ã¾ãšã¯ ã“ã“ã‹ã‚‰ï¼</p>
<div class="mt-4 flex gap-1">
<div class="w-6 h-6 rounded-full bg-red-500 border-2 border-white"></div>
<div class="w-6 h-6 rounded-full bg-blue-500 border-2 border-white"></div>
<div class="w-6 h-6 rounded-full bg-yellow-400 border-2 border-white"></div>
</div>
</div>
<span class="material-symbols-rounded absolute -right-4 -bottom-4 text-9xl text-green-100 opacity-50 transform rotate-12">sentiment_satisfied</span>
</button>
<!-- Challenge Course -->
<button class="flex-1 bg-white hover:bg-purple-50 border-4 border-purple-400 rounded-3xl p-8 shadow-lg hover:shadow-xl hover:scale-105 transition-all group text-left relative overflow-hidden" onclick="startGame('challenge')">
<div class="relative z-10">
<span class="bg-purple-100 text-purple-600 px-3 py-1 rounded-full text-xs font-black tracking-widest mb-2 inline-block">ã‚€ãšã‹ã—ã„</span>
<h3 class="text-2xl font-black text-purple-600 mb-2">ãƒãƒ£ãƒ¬ãƒ³ã‚¸ ã‚³ãƒ¼ã‚¹</h3>
<p class="text-slate-500 text-sm font-bold">ãƒ•ã‚¯ã‚¶ãƒ„ãª ã„ã‚ãŒ ã§ã‚‹ã‚ˆã€‚<br>ãã¿ã¯ ã‚¯ãƒªã‚¢ã§ãã‚‹ï¼Ÿ</p>
<div class="mt-4 flex gap-1">
<div class="w-6 h-6 rounded-full bg-orange-500 border-2 border-white"></div>
<div class="w-6 h-6 rounded-full bg-purple-700 border-2 border-white"></div>
<div class="w-6 h-6 rounded-full bg-teal-600 border-2 border-white"></div>
</div>
</div>
<span class="material-symbols-rounded absolute -right-4 -bottom-4 text-9xl text-purple-100 opacity-50 transform rotate-12">military_tech</span>
</button>
</div>
</div>
<!-- GAME: Main Screen -->
<div class="hidden max-w-4xl mx-auto w-full h-full flex flex-col" id="game-main">
<!-- Game Header -->
<div class="flex justify-between items-center mb-6 bg-white p-4 rounded-2xl shadow-sm">
<div class="flex items-center gap-3">
<button class="bg-slate-100 hover:bg-slate-200 p-2 rounded-xl text-slate-500 transition" onclick="exitGame()">
<span class="material-symbols-rounded">arrow_back</span>
</button>
<div>
<span class="text-xs font-black px-2 py-0.5 rounded-full mb-1 inline-block" id="game-mode-badge">ãƒ¢ãƒ¼ãƒ‰</span>
<h2 class="text-xl font-black text-slate-700 leading-none">ã‚‚ã‚“ã ã„ <span class="text-2xl text-blue-500" id="level-display">1</span> / 10</h2>
</div>
</div>
<!-- Stars/Score placeholder -->
<div class="flex gap-1" id="score-stars">
<!-- JS will populate stars -->
</div>
</div>
<div class="flex flex-col md:flex-row gap-4 md:gap-8 items-center justify-center flex-1">
<!-- Target -->
<div class="bg-white p-6 rounded-3xl shadow-lg border-4 border-white flex flex-col items-center w-full md:w-1/3 order-1">
<span class="text-xs font-black text-slate-400 mb-2 tracking-widest">ãŠã¦ã»ã‚“</span>
<div class="w-32 h-32 md:w-40 md:h-40 rounded-full shadow-inner border-4 border-slate-100 mb-4 transition-colors duration-300" id="game-target" style="background-color: #ff0000;"></div>
<div class="bg-yellow-50 text-yellow-800 px-4 py-2 rounded-xl text-sm font-bold w-full text-center">
<span class="block text-xs opacity-70 mb-1">ãƒ’ãƒ³ãƒˆ</span>
<span id="game-hint">ã‚ã‹è‰²ã‚’ ã¾ãœã¦ã¿ã‚ˆã†</span>
</div>
</div>
<!-- VS -->
<div class="text-4xl font-black text-slate-300 transform rotate-12 order-2">VS</div>
<!-- Player -->
<div class="bg-white p-6 rounded-3xl shadow-lg border-4 border-blue-200 flex flex-col items-center w-full md:w-1/3 relative overflow-hidden order-3">
<span class="text-xs font-black text-blue-400 mb-2 tracking-widest">ã‚ãªãŸã®ã„ã‚</span>
<div class="w-32 h-32 md:w-40 md:h-40 rounded-full shadow-md border-4 border-white mb-6 transition-colors duration-100" id="game-player" style="background-color: #808080;"></div>
<!-- Simple Sliders -->
<div class="w-full space-y-4">
<div class="flex items-center gap-2">
<span class="material-symbols-rounded text-red-500">circle</span>
<input class="game-slider" id="game-r" max="255" min="0" type="range" value="128">
</div>
<div class="flex items-center gap-2">
<span class="material-symbols-rounded text-green-500">circle</span>
<input class="game-slider" id="game-g" max="255" min="0" type="range" value="128">
</div>
<div class="flex items-center gap-2">
<span class="material-symbols-rounded text-blue-500">circle</span>
<input class="game-slider" id="game-b" max="255" min="0" type="range" value="128">
</div>
</div>
</div>
</div>
<!-- Footer / Action -->
<div class="mt-4 text-center h-24 flex flex-col items-center justify-center relative">
<button class="bg-blue-500 hover:bg-blue-600 text-white font-black py-3 px-12 rounded-full text-xl shadow-[0_4px_0_#1e40af] active:shadow-none active:translate-y-1 transition-all transform hover:scale-105" id="check-btn" onclick="checkAnswer()">
                        ã§ããŸï¼
                    </button>
<!-- Result Modal (Inline) -->
<div class="hidden flex flex-col items-center animate-jelly absolute inset-0 bg-blue-50 z-10 justify-center" id="result-modal">
<h3 class="text-2xl font-black text-slate-800 mb-1" id="result-title">ã™ã”ã„ï¼</h3>
<p class="text-lg font-bold text-slate-600 mb-2" id="result-score">98ã¦ã‚“</p>
<button class="text-white bg-green-500 px-6 py-2 rounded-full font-bold shadow-[0_2px_0_#15803d] active:translate-y-0.5 active:shadow-none transition" onclick="nextLevel()">ã¤ãã¸</button>
</div>
</div>
</div>
<!-- GAME: Completion Screen -->
<div class="hidden max-w-4xl mx-auto w-full h-full flex flex-col items-center justify-center text-center animate-jelly" id="game-complete">
<span class="material-symbols-rounded text-8xl text-yellow-400 mb-4 animate-bounce">emoji_events</span>
<h2 class="text-4xl font-black text-slate-800 mb-2">ã‚³ãƒ¼ã‚¹ ã‚¯ãƒªã‚¢ï¼</h2>
<p class="text-xl font-bold text-slate-500 mb-8">ãŠã‚ã§ã¨ã†ï¼ã•ã„ã”ã¾ã§ ã§ããŸã­ï¼</p>
<div class="bg-white p-6 rounded-2xl shadow-lg border-2 border-slate-100 mb-8">
<p class="text-sm font-bold text-slate-400 mb-1">ã‚ãªãŸã® ã‚¹ã‚³ã‚¢</p>
<p class="text-5xl font-black text-blue-500" id="final-score">850<span class="text-xl text-slate-400 ml-2">/ 1000</span></p>
</div>
<button class="bg-slate-800 text-white px-8 py-4 rounded-2xl font-bold shadow-lg hover:bg-slate-700 transition" onclick="exitGame()">
                    ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã« ã‚‚ã©ã‚‹
                </button>
</div>
</div>
</main>
<!-- Toast Notification -->
<div class="fixed top-24 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-2 pointer-events-none opacity-0 transition-all duration-300 translate-y-4 z-50" id="toast">
<span class="material-symbols-rounded text-green-400">check_circle</span>
<span class="font-bold">ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆï¼</span>
</div>
<script>
        /* ==================== DOWNLOAD FUNCTION ==================== */
        function downloadSource() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'color-lab-dx.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        /* ==================== SHARED UTILS ==================== */
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase();
        }

        function getTextColor(r, g, b) {
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 128 ? '#1e293b' : '#ffffff';
        }

        /* ==================== TAB SWITCHING ==================== */
        function switchTab(mode) {
            const labBtn = document.getElementById('tab-lab');
            const gameBtn = document.getElementById('tab-game');
            const labView = document.getElementById('view-lab');
            const gameView = document.getElementById('view-game');

            if(mode === 'lab') {
                labBtn.className = "px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold transition-all bg-yellow-400 text-white shadow-[0_2px_0_rgba(180,83,9,0.3)] flex items-center gap-1 md:gap-2";
                gameBtn.className = "px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold text-slate-400 hover:text-slate-600 transition-all flex items-center gap-1 md:gap-2";
                labView.classList.remove('hidden');
                gameView.classList.add('hidden');
            } else {
                gameBtn.className = "px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold transition-all bg-blue-500 text-white shadow-[0_2px_0_#1e40af] flex items-center gap-1 md:gap-2";
                labBtn.className = "px-3 py-1.5 md:px-4 md:py-2 rounded-xl text-xs md:text-base font-bold text-slate-400 hover:text-slate-600 transition-all flex items-center gap-1 md:gap-2";
                gameView.classList.remove('hidden');
                labView.classList.add('hidden');

                // Return to menu if game is not active
                if(gameState.state === 'menu') {
                    showGameScreen('menu');
                }
            }
        }

        /* ==================== LAB MODE LOGIC (ä¿®æ­£ç‰ˆ) ==================== */

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’è¿½åŠ ã—ã¦ã€updateLabã®æŒ™å‹•ã‚’åˆ¶å¾¡
        let isUsingRecipe = false;

        function updateLab() {
            // ã‚‚ã—ãƒ¬ã‚·ãƒ”ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸç›´å¾Œãªã‚‰ã€åå‰ã®è‡ªå‹•åˆ¤å®šã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ï¼ˆsetRGBã§è¨­å®šã•ã‚ŒãŸåå‰ã‚’ç¶­æŒï¼‰
            // ãŸã ã—ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’å‹•ã‹ã—ã¦ã“ã“ã«æ¥ãŸå ´åˆã¯ isUsingRecipe ãƒ•ãƒ©ã‚°ã‚’ã‚ªãƒ•ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
            // ã“ã“ã§ã¯ã€Œã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œæ™‚ã€ã«å‘¼ã°ã‚Œã‚‹ã“ã¨ã‚’å‰æã«ãƒ­ã‚¸ãƒƒã‚¯ã‚’çµ„ã‚€

            const r = parseInt(document.getElementById('slider-r').value);
            const g = parseInt(document.getElementById('slider-g').value);
            const b = parseInt(document.getElementById('slider-b').value);

            document.getElementById('txt-r').textContent = r;
            document.getElementById('txt-g').textContent = g;
            document.getElementById('txt-b').textContent = b;

            const color = `rgb(${r}, ${g}, ${b})`;
            const hex = rgbToHex(r, g, b);

            const blob = document.getElementById('blob-character');
            blob.style.backgroundColor = color;
            blob.style.color = getTextColor(r,g,b);

            document.getElementById('hex-code').textContent = hex;

            // ã‚‚ã— setRGB ã‹ã‚‰ã®å‘¼ã³å‡ºã—ï¼ˆãƒ•ãƒ©ã‚°ãŒtrueï¼‰ã§ãªã‘ã‚Œã°ã€è‡ªå‹•åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã‚’èµ°ã‚‰ã›ã‚‹
            if (!isUsingRecipe) {
                // è‡ªå‹•åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå³æ ¼åŒ–ï¼šèµ¤é’ç·‘ç™½é»’ä»¥å¤–ã¯ã™ã¹ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼‰
                let name = "ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼";

                // å³å¯†ãªåˆ¤å®šé–¾å€¤ (Pureãªè‰²ã«éå¸¸ã«è¿‘ã„å ´åˆã®ã¿åå‰ã‚’å‡ºã™)
                const threshold = 10;

                // ç™½ (White)
                if (r > 255 - threshold && g > 255 - threshold && b > 255 - threshold) {
                    name = "ã¾ã£ã—ã‚";
                }
                // é»’ (Black)
                else if (r < threshold && g < threshold && b < threshold) {
                    name = "ã¾ã£ãã‚";
                }
                // èµ¤ (Red) - ç·‘é’ãŒã»ã¼0ã€èµ¤ãŒå¼·ã„
                else if (r > 200 && g < threshold && b < threshold) {
                    name = "ã‚ã‹";
                }
                // ç·‘ (Green) - èµ¤é’ãŒã»ã¼0ã€ç·‘ãŒå¼·ã„
                else if (g > 200 && r < threshold && b < threshold) {
                    name = "ã¿ã©ã‚Š";
                }
                // é’ (Blue) - èµ¤ç·‘ãŒã»ã¼0ã€é’ãŒå¼·ã„
                else if (b > 200 && r < threshold && g < threshold) {
                    name = "ã‚ãŠ";
                }
                // ãã‚Œä»¥å¤–ã¯ã™ã¹ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼
                else {
                    name = "ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼";
                }

                document.getElementById('color-name-display').textContent = name;
            }

            // å‡¦ç†ãŒçµ‚ã‚ã£ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’æˆ»ã™ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œæ™‚ã¯å¸¸ã«falseã§å‡¦ç†ã•ã‚Œã‚‹ï¼‰
            isUsingRecipe = false;
        }

        // ãƒ¬ã‚·ãƒ”ãƒœã‚¿ãƒ³ç”¨ã®é–¢æ•°ï¼ˆåå‰ã‚’å¼·åˆ¶æŒ‡å®šï¼‰
        function setRGB(r, g, b, forcedName) {
            // ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ã€updateLabå†…ã§ã®è‡ªå‹•åˆ¤å®šã‚’ç„¡åŠ¹åŒ–ï¼ˆã¾ãŸã¯å¾Œæ›¸ãã™ã‚‹ï¼‰
            isUsingRecipe = true;

            document.getElementById('slider-r').value = r;
            document.getElementById('slider-g').value = g;
            document.getElementById('slider-b').value = b;

            // ã¾ãšæ•°å€¤ã‚„è‰²ã‚’æ›´æ–°
            updateLab();

            // updateLabãŒå®Ÿè¡Œã•ã‚ŒãŸå¾Œã«ã€åå‰ã‚’å¼·åˆ¶çš„ã«ä¸Šæ›¸ãã™ã‚‹
            // ï¼ˆupdateLabå†…ã§ isUsingRecipe=true ã®ãŸã‚è‡ªå‹•åˆ¤å®šã¯ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã‹ã£ãŸãŒã€
            //  ã‚³ãƒ¼ãƒ‰ã®ç°¡æ½”ã•ã®ãŸã‚ updateLab ã®ã‚ã¨ã«ä¸Šæ›¸ãã™ã‚‹ã»ã†ãŒç¢ºå®Ÿï¼‰
            document.getElementById('color-name-display').textContent = forcedName;

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            const char = document.getElementById('blob-character');
            char.classList.remove('animate-jelly');
            void char.offsetWidth;
            char.classList.add('animate-jelly');

            // æ¬¡ã®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œã®ãŸã‚ã«ãƒ•ãƒ©ã‚°ã‚’æˆ»ã™å¿…è¦ã¯ãªã„ï¼ˆsliderã®inputã‚¤ãƒ™ãƒ³ãƒˆã¯ isUsingRecipe=false ã§å…¥ã£ã¦ãã‚‹ãŸã‚ï¼‰
            // ãŸã ã—ã€å¿µã®ãŸã‚ã“ã“ã§ãƒªã‚»ãƒƒãƒˆã—ã¦ãŠã
            isUsingRecipe = false;
        }

        function copyColor() {
            const hex = document.getElementById('hex-code').textContent;
            navigator.clipboard.writeText(hex).then(() => {
                const toast = document.getElementById('toast');
                toast.classList.remove('opacity-0', 'translate-y-4');
                setTimeout(() => {
                    toast.classList.add('opacity-0', 'translate-y-4');
                }, 2000);
            });
        }

        ['slider-r', 'slider-g', 'slider-b'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œæ™‚ã¯ãƒ•ãƒ©ã‚°ã‚’falseã«ã—ã¦è‡ªå‹•åˆ¤å®šã‚’æœ‰åŠ¹ã«ã™ã‚‹
                isUsingRecipe = false;
                updateLab();
            });
        });

        /* ==================== GAME MODE LOGIC (DX) ==================== */

        const LEVELS_NORMAL = [
            { t:[255, 0, 0], h:"ã€Œã‚ã‹ã€ã‚’ ã¾ã£ãã™ã« ã—ã¦ã¿ã‚ˆã†ï¼", n:"ã‚ã‹" },
            { t:[0, 255, 0], h:"ã€Œã¿ã©ã‚Šã€ã‚’ ã¾ã£ãã™ã«ï¼", n:"ã¿ã©ã‚Š" },
            { t:[0, 0, 255], h:"ã€Œã‚ãŠã€ã‚’ ã¾ã£ãã™ã«ï¼", n:"ã‚ãŠ" },
            { t:[255, 255, 255], h:"ãœã‚“ã¶ ã¾ã£ãã™ã§ ã²ã‹ã‚Šã‹ãŒã‚„ãï¼", n:"ã—ã‚" },
            { t:[0, 0, 0], h:"ãœã‚“ã¶ ã‚¼ãƒ­ã« ã™ã‚‹ã¨...ï¼Ÿ", n:"ãã‚" },
            { t:[255, 255, 0], h:"ã€Œã‚ã‹ã€ã¨ã€Œã¿ã©ã‚Šã€ã‚’ ã¾ãœã‚‹ã‚ˆ", n:"ãã„ã‚" },
            { t:[0, 255, 255], h:"ã€Œã¿ã©ã‚Šã€ã¨ã€Œã‚ãŠã€ã‚’ ã¾ãœã‚‹ã‚ˆ", n:"ã¿ãšã„ã‚" },
            { t:[255, 0, 255], h:"ã€Œã‚ã‹ã€ã¨ã€Œã‚ãŠã€ã‚’ ã¾ãœã‚‹ã‚ˆ", n:"ãƒ”ãƒ³ã‚¯" },
            { t:[128, 128, 128], h:"ãœã‚“ã¶ ã¾ã‚“ãªã‹ ãã‚‰ã„ã ã‚ˆ", n:"ã‚°ãƒ¬ãƒ¼" },
            { t:[255, 128, 128], h:"ã€Œã‚ã‹ã€ã¯ã¾ã£ãã™ã€‚ã»ã‹ã¯ã¯ã‚“ã¶ã‚“ã€‚", n:"ã†ã™ã„ã‚ã‹" },
        ];

        const LEVELS_CHALLENGE = [
            { t:[255, 165, 0], h:"ã‚ã‹ã‚’ãŸãã•ã‚“ã€ã¿ã©ã‚Šã‚’ã™ã“ã—", n:"ã‚ªãƒ¬ãƒ³ã‚¸" },
            { t:[128, 0, 128], h:"ã‚ã‹ã¨ã‚ãŠã‚’ ã¯ã‚“ã¶ã‚“ãšã¤", n:"ã‚€ã‚‰ã•ã" },
            { t:[0, 0, 128], h:"ã‚ãŠã ã‘ ã¯ã‚“ã¶ã‚“ã®ã¤ã‚ˆã•", n:"ã“ã‚“ã„ã‚" },
            { t:[165, 42, 42], h:"ã‚ã‹ã‚’ã™ã“ã—ã€ã¿ã©ã‚Šã¯ã‚‚ã£ã¨ã™ã“ã—", n:"ã¡ã‚ƒã„ã‚" },
            { t:[255, 215, 0], h:"ãã„ã‚ã« ã™ã“ã—ã‚ã‹ã¿ãŒã‚ã‚‹ã‹ãªï¼Ÿ", n:"ã‚´ãƒ¼ãƒ«ãƒ‰" },
            { t:[0, 128, 0], h:"ã¿ã©ã‚Šã ã‘ ã¯ã‚“ã¶ã‚“ã®ã¤ã‚ˆã•", n:"ãµã‹ã„ã¿ã©ã‚Š" },
            { t:[255, 105, 180], h:"ã‚ã‹ã‚’ã¤ã‚ˆãã€ã¿ã©ã‚Šã‚’ã™ã“ã—ã€ã‚ãŠã‚‚ã¤ã‚ˆã", n:"ãƒ›ãƒƒãƒˆãƒ”ãƒ³ã‚¯" },
            { t:[128, 128, 0], h:"ã‚ã‹ã¨ã¿ã©ã‚Šã‚’ ã¯ã‚“ã¶ã‚“ãšã¤", n:"ã‚ªãƒªãƒ¼ãƒ–" },
            { t:[64, 224, 208], h:"ã¿ã©ã‚Šã¨ã‚ãŠã‚’ ã¤ã‚ˆãã€ã‚ã‹ã¯ã™ã“ã—", n:"ã‚¿ãƒ¼ã‚³ã‚¤ã‚º" },
            { t:[75, 0, 130], h:"ã‚ã‹ã¯ã™ã“ã—ã€ã‚ãŠã‚’ã¯ã‚“ã¶ã‚“ãã‚‰ã„", n:"ã‚¤ãƒ³ãƒ‡ã‚£ã‚´" },
        ];

        let gameState = {
            state: 'menu', // menu, playing, complete
            mode: 'normal',
            currentLevelIndex: 0,
            score: 0,
            levels: []
        };

        function showGameScreen(id) {
            ['game-menu', 'game-main', 'game-complete'].forEach(elId => {
                document.getElementById(elId).classList.add('hidden');
            });
            document.getElementById(`game-${id}`).classList.remove('hidden');
        }

        function startGame(mode) {
            gameState.state = 'playing';
            gameState.mode = mode;
            gameState.currentLevelIndex = 0;
            gameState.score = 0;
            gameState.levels = mode === 'normal' ? LEVELS_NORMAL : LEVELS_CHALLENGE;

            const badge = document.getElementById('game-mode-badge');
            if(mode === 'normal') {
                badge.className = "text-xs font-black px-2 py-0.5 rounded-full mb-1 inline-block bg-green-100 text-green-600";
                badge.textContent = "ãµã¤ã† ã‚³ãƒ¼ã‚¹";
            } else {
                badge.className = "text-xs font-black px-2 py-0.5 rounded-full mb-1 inline-block bg-purple-100 text-purple-600";
                badge.textContent = "ãƒãƒ£ãƒ¬ãƒ³ã‚¸ ã‚³ãƒ¼ã‚¹";
            }

            document.getElementById('score-stars').innerHTML = '';

            showGameScreen('main');
            loadLevel(0);
        }

        function exitGame() {
            gameState.state = 'menu';
            showGameScreen('menu');
        }

        function loadLevel(idx) {
            const levelData = gameState.levels[idx];
            document.getElementById('level-display').textContent = idx + 1;

            const targetColor = `rgb(${levelData.t[0]}, ${levelData.t[1]}, ${levelData.t[2]})`;
            document.getElementById('game-target').style.backgroundColor = targetColor;
            document.getElementById('game-hint').textContent = levelData.h;

            document.getElementById('game-r').value = 128;
            document.getElementById('game-g').value = 128;
            document.getElementById('game-b').value = 128;
            updateGamePreview();

            document.getElementById('check-btn').classList.remove('hidden');
            document.getElementById('result-modal').classList.add('hidden');
        }

        function updateGamePreview() {
            const r = document.getElementById('game-r').value;
            const g = document.getElementById('game-g').value;
            const b = document.getElementById('game-b').value;
            document.getElementById('game-player').style.backgroundColor = `rgb(${r},${g},${b})`;
        }

        function checkAnswer() {
            const r = parseInt(document.getElementById('game-r').value);
            const g = parseInt(document.getElementById('game-g').value);
            const b = parseInt(document.getElementById('game-b').value);

            const target = gameState.levels[gameState.currentLevelIndex].t;

            const dist = Math.sqrt(
                Math.pow(r - target[0], 2) +
                Math.pow(g - target[1], 2) +
                Math.pow(b - target[2], 2)
            );
            const maxDist = Math.sqrt(255*255*3);
            const score = Math.max(0, Math.floor(100 - (dist/maxDist * 100)));

            gameState.score += score;

            document.getElementById('check-btn').classList.add('hidden');
            const modal = document.getElementById('result-modal');
            modal.classList.remove('hidden');

            const title = document.getElementById('result-title');
            if(score >= 95) {
                title.textContent = "ã¦ã‚“ã•ã„ï¼";
                title.className = "text-2xl font-black text-yellow-500 mb-1";
            } else if(score >= 80) {
                title.textContent = "ã™ã”ã„ï¼";
                title.className = "text-2xl font-black text-green-500 mb-1";
            } else {
                title.textContent = "ãŠã—ã„ï¼";
                title.className = "text-2xl font-black text-slate-500 mb-1";
            }
            document.getElementById('result-score').textContent = score + "ã¦ã‚“";

            const star = document.createElement('span');
            star.className = "material-symbols-rounded text-sm " + (score >= 80 ? "text-yellow-400" : "text-slate-200");
            star.textContent = "star";
            document.getElementById('score-stars').appendChild(star);
        }

        function nextLevel() {
            gameState.currentLevelIndex++;
            if(gameState.currentLevelIndex >= gameState.levels.length) {
                showGameScreen('complete');
                document.getElementById('final-score').innerHTML = gameState.score + `<span class="text-xl text-slate-400 ml-2">/ 1000</span>`;
            } else {
                loadLevel(gameState.currentLevelIndex);
            }
        }

        ['game-r', 'game-g', 'game-b'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateGamePreview);
        });

        /* ==================== INIT ==================== */
        // åˆæœŸçŠ¶æ…‹ã¯ã‚°ãƒ¬ãƒ¼ï¼ˆã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ï¼‰
        document.getElementById('color-name-display').textContent = "ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼";
        updateLab();

    </script>

</body></html>